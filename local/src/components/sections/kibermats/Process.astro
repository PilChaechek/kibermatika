---
import Badge from "../../../assets/images/badges/hand3.png";
import img1 from "../../../assets/images/process/1.png";
import img2 from "../../../assets/images/process/2.png";
import img3 from "../../../assets/images/process/3.png";
import img4 from "../../../assets/images/process/4.png";
import img5 from "../../../assets/images/process/5.png";
import iconInfo from "../../../assets/icons/info.svg?raw";
import {Image} from "astro:assets";

---
<section class="section process">
    <div class="container">
        <div class="section__header">
            <div class="section__badge">
                <div class="icon-badge icon-badge--v4">
                    <div class="icon-badge__icon">
                        <div class="icon-badge__icon-wrp">
                            <Image
                                    src={Badge}
                                    alt=""
                                    format="webp"
                                    quality={90}
                                    class="img icon-badge__icon-src pulse"
                            />
                        </div>
                    </div>
                    <div class="icon-badge__text">
                        в офисе<br /> и на удаленке
                    </div>
                </div>
            </div>
            <h2 class="section__title">Включены в процесс на 110%</h2>
            <p class="section__text">Сделали все процессы прозрачными, а результаты явными. Построили систему <br> управления командами, организовали удобные цифровые рабочие места, а наша <br> штаб-квартира в Подольске всегда открыта для команды и партнеров.
            </p>
        </div>
    </div>
    <div class="process__items info-pills">

    <div class="info-pills__row swiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide info-pills__after">
                <div class="pill pill--v1">
                    <span class="pill__text">Регулярные One-to-One</span>
                    <Image
                        src={img1}
                        alt=""
                        format="webp"
                        quality={90}
                        class="img pill__img"
                    />
                </div>
            </div>
            <div class="swiper-slide">
                <div class="pill pill--v2">
                    <span class="pill__text">Публичные планы всей компании</span>
                    <Image
                        src={img2}
                        alt=""
                        format="webp"
                        quality={90}
                        class="img pill__img"
                    />
                </div>
                </div>
            </div>
        </div>

        <div class="info-pills__row swiper">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div class="pill pill--v7">
                        <span class="pill__text">Автоматизация повторяющихся процессов</span>
                        <Image
                            src={img3}
                            alt=""
                            format="webp"
                            quality={90}
                            class="img pill__img"
                        />
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="pill pill--link pill--v3">
                        <a href="#" class="pill__link link">
                            <span class="pill__text">
                                LMS и Хелп-Деск
                            </span>
                        </a>
                        <button
                                type="button"
                                class="pill__tippy btn-reset term-trigger"
                                data-tippy-content="Внутренняя система помощи и обучения"
                                aria-label="Подробнее о термине Кибермат"
                                set:html={iconInfo}>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="info-pills__row swiper">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div class="pill pill--v4 ">
                        <span class="pill__text">
                            StandUp отделов c прожаркой

                            <button
                                    type="button"
                                    class="pill__tippy btn-reset term-trigger"
                                    data-tippy-content="Так мы называем себя и команду"
                                    aria-label="Подробнее о термине Кибермат"
                                    set:html={iconInfo}>
                            </button>

                        </span>
                        <Image
                            src={img4}
                            alt=""
                            format="webp"
                            quality={90}
                            class="img pill__img"
                        />
                    </div>
                </div>
                <div class="swiper-slide info-pills__before">
                    <div class="pill pill--v5">
                        <span class="pill__text">Открытые коридоры связи</span>
                    </div>
                </div>

            </div>
        </div>

        <div class="info-pills__row swiper">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div class="pill pill--v6">
                        <span class="pill__text">Оценка здравого смысла и открытость к критике</span>
                        <Image
                            src={img5}
                            alt=""
                            format="webp"
                            quality={90}
                            class="img pill__img"
                        />
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    import Swiper from 'swiper';
    import { FreeMode } from "swiper/modules";
    import tippy, { hideAll } from 'tippy.js';

    document.addEventListener('DOMContentLoaded', () => {

        const swiperElements = document.querySelectorAll('.process .info-pills__row.swiper');

        swiperElements.forEach(el => {
            new Swiper(el, {
                modules: [FreeMode],
                slidesPerView: "auto",
                freeMode: true,
                spaceBetween: 6,
                slidesOffsetAfter: 12,
                slidesOffsetBefore: 12,
                on: {
                    sliderMove: () => {
                        // Скрываем все тултипы мгновенно при начале движения
                        hideAll({ duration: 0 });
                    }
                },
                breakpoints: {
                    740: {
                        enabled: false,
                        slidesOffsetAfter: 0,
                        slidesOffsetBefore: 0,
                    }
                }
            });
        });

    });

    // Tippy

    tippy('.term-trigger', {
        trigger: 'click',
        //trigger: 'mouseenter focus',
        placement: 'right-end',
        offset: ({ placement }) => {
            const isMobile = window.innerWidth < 768;
            // Если тултип перевернулся вниз
            if (placement.startsWith('bottom')) {
                return [0, 10]; // 0 сдвиг, 10 отступ вниз
            }
            // Если он все еще справа (десктоп или планшет)
            return isMobile ? [-12, 4] : [-24, 6];
        },
        //animation: 'scale',
        theme: 'custom',
        maxWidth: 240,
        interactive: true,
        appendTo: () => document.body,
    });

</script>