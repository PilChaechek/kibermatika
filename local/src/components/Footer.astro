---
export interface Props {
    variant?: string;
}

const { variant = "1" } = Astro.props;

const navItems = [
    { title: "продукты", href: "/#products" },
    { title: "команда", href: "/about/#commands" },
    { title: "вакансии", href: "https://spb.hh.ru/employer/5471863?hhtmFrom=vacancy" },
    { title: "люди", href: "/#peoples" },
    { title: "музыка", href: "https://kinescope.io/embed/o2VSMBcg6GT3RT7z246RbP" },
    { title: "фестивали", href: "https://kinescope.io/embed/qnoqDS9mQnvyPtF8LvwgFB" },
];
---
<footer class="page-footer section--v5" id="contacts">
    <div class="container">
        <div class="page-footer__inner">
            <div class="page-footer__top">
                <div class="page-footer__contacts">
                    <div class="page-footer__contacts-title">
                        открыты новому
                        <svg width="44" height="38" viewBox="0 0 44 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4.62927 21.292H0V16.708H4.62927V21.292ZM5.62439 16.708H10.2537V21.292H5.62439V16.708ZM11.2488 16.708H15.8781V21.292H11.2488V16.708ZM16.8732 16.708H21.5024V21.292H16.8732V16.708ZM22.4976 4.58396V0H27.1268V4.58396H22.4976ZM27.1268 21.292H22.4976V16.708H27.1268V21.292ZM22.4976 33.416H27.1268V38H22.4976V33.416ZM28.122 5.56934H32.7512V10.1533H28.122V5.56934ZM28.122 16.708H32.7512V21.292H28.122V16.708ZM32.7512 32.4267H28.122V27.8428H32.7512V32.4267ZM38.3756 15.7187H33.7463V11.1347H38.3756V15.7187ZM33.7463 21.288V16.7041H38.3756V21.288H33.7463ZM33.7463 26.8574V22.2734H38.3756V26.8574H33.7463ZM39.3707 16.708H44V21.292H39.3707V16.708Z" fill="#101651" />
                        </svg>
                    </div>
                    <div class="page-footer__contacts-link">
                        <a class="link link--color-2" href="mailto:hey@cybermatica.com">hey@cybermatica.com</a>
                    </div>
                    <div class="page-footer__contacts-link">
                        <a class="link link--color-2" href="tel:79992345678">+7 999 2345678</a>
                    </div>
                </div>

                <div class="page-footer__subscribe subscribe">
                    <div class="subscribe__title">Стать киберматом</div>
                    <form class="subscribe__form input-button">
                        <input class="input input-button__input" type="text" placeholder="эл.почта">
                        <button type="button" class="input-button__button btn-reset btn--arrow">
                            <svg width="57" height="57" viewBox="0 0 57 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M38 27H34V31H38V27Z" />
                                <path d="M34 30H30V34H34V30Z" />
                                <path d="M30 34H26V38H30V34Z" />
                                <path d="M27 38H23V42H27V38Z" />
                                <path d="M27 15H23V19H27V15Z" />
                                <path d="M30 19H26V23H30V19Z" />
                                <path d="M34 23H30V27H34V23Z" />
                            </svg>
                        </button>
                    </form>
                </div>
            </div>

            <nav class="page-footer__nav footer-nav">
                {
                    navItems.map((item) => (
                        <div class="footer-nav__item">
                            <a href={item.href} class="footer-nav__link link--color">{item.title}</a>
                        </div>
                    ))
                }
            </nav>

            <div class="page-footer__bottom">
                <div class="page-footer__bottom-item">
                    <a class="link">© ООО «Киберматика» 2025</a>
                </div>

                <div class="page-footer__bottom-item page-footer__sphere">
                    <div class="sphere" data-variant={variant}>
                        <button class="sphere__btn btn-reset" type="button" aria-label="Дропнуть басс">
                            <video
                                    class="sphere-video"
                                    src="/assets/video/bass4.mp4"
                                    autoplay
                                    muted
                                    loop
                                    playsinline
                            ></video>
                            <span class="sphere__text">дропнуть <br> бас</span>
                        </button>
                    </div>
                </div>

                <div class="page-footer__bottom-item page-footer__quote">
                    без корпоративной чепухи
                </div>
            </div>
            <div class="page-footer__copyright">
                <a class="link link--color" href="/agreement/">Политика обработки персональных данных</a>
            </div>
        </div>
    </div>
</footer>
<script>
    import { gsap } from 'gsap';

    const initRipples = () => {
        const spheres = document.querySelectorAll('.sphere');

        spheres.forEach((sphereContainer) => {
            const btn = sphereContainer.querySelector('.sphere__btn');
            if (!btn) return;

            // Получаем вариант из data-атрибута, по умолчанию "1"
            const variant = sphereContainer.dataset.variant || "1";

            // Настройки эффекта общие для всех вариантов
            const CONFIG = {
                waveCount: 2,        // Сколько волн за 1 клик
                staggerDelay: 0.2,   // Задержка между волнами
                baseDuration: 1.2,   // Базовое время жизни волны
                maxScale: 2.5        // Во сколько раз увеличивается (относительно кнопки)
            };

            btn.addEventListener('click', () => {
                for (let i = 0; i < CONFIG.waveCount; i++) {
                    createRipple(sphereContainer, i, variant, CONFIG);
                }
            });
        });

        function createRipple(container, index, variant, config) {
            const ripple = document.createElement('div');
            ripple.classList.add('ripple-wave');
            // Добавляем класс, специфичный для варианта
            ripple.classList.add(`ripple-wave--v${variant}`);
            container.appendChild(ripple);

            // Анимация GSAP
            gsap.fromTo(ripple,
                {
                    scale: 1,
                    opacity: 0.8,
                },
                {
                    scale: config.maxScale + (index * 0.3),
                    opacity: 0,
                    duration: config.baseDuration + (index * 0.2),
                    delay: index * config.staggerDelay,
                    ease: "power2.out", // Естественное затухание
                    onComplete: () => {
                        // Чистим DOM после завершения
                        ripple.remove();
                    }
                }
            );
        }
    };

    // Запускаем
    initRipples();

    // Если в Astro используется View Transitions (router), нужно переинициализировать скрипт
    document.addEventListener('astro:page-load', initRipples);
</script>